<!DOCTYPE html>
<html lang="es">

<head>

  <meta charset="utf-8">
  <title>Analisis de Algoritmos</title>
  <script type="text/javascript" src="dist/vis.js"></script>
  <link href="dist/vis-network.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="estilos.css">
  <script type="text/javascript">
    var nodes = null;
    var edges = null;
    var network = null;
    // randomly create some nodes and edges
    var data = {};//getScaleFreeNetwork(25);
    var seed = 2;
    const names_nodo = [];

    function setDefaultLocale() {
      var defaultLocal = navigator.language;
      var select = document.getElementById('locale');
      select.selectedIndex = 0; // set fallback value
      for (var i = 0, j = select.options.length; i < j; ++i) {
        if (select.options[i].getAttribute('value') === 'es') {
          select.selectedIndex = i;
          break;
        }
      }
    }

    function destroy() {
      if (network !== null) {
        network.destroy();
        network = null;
      }
    }

    function draw() {
      destroy();
      nodes = [];
      edges = [];
      var conta = 1;
      var container = document.getElementById('mynetwork');
      var options =
      {
        nodes:
        {
          shape: 'box',
        },
        edges:
        {

          arrows: 'to',
          font:
          {
            align: 'horizontal'
          }
        },
        physics: false,
        //layout: {randomSeed:seed}, // just to make sure the layout is the same when the locale is changed
        locale: 'es',
        manipulation: {
          addNode: function (data, callback) {
            // filling in the popup DOM elements
            //document.getElementById('node-operation').innerHTML = "Añadir nodo";
            //editNode(data, callback);
            
            var label;
            var nr;
            console.log(names_nodo);
            while (!label) {
              label = prompt("Ingresa el nombre del nodo", "nodo" + conta);
              console.log("wsadas")
              if (names_nodo.length != 0) {
                console.log("banif")
                for (var i = 0; i < names_nodo.length; i++) {
                  console.log(names_nodo[i])
                  if (label == names_nodo[i]) {
                    label = "";
                    nr = 1;
                    alert("El nombre del nodo ya esta en uso, por favor ingresa otro nombre");
                  }
                }
                if (nr != 1) {
                  names_nodo.push(label);
                  conta++;
                }
              } else {
                console.log("banelse")
                if (names_nodo.length == 0 || nr != 1) {
                  names_nodo.push(label);
                  conta++;
                }
              }
            }
            data.label = label;
            callback(data);
              //console.log(data);
            },
            /*editNode: function (data, callback) {
              // filling in the popup DOM elements
              document.getElementById('node-operation').innerHTML = "Editar nodo";
              editNode(data, callback);
            },*/
            addEdge: function (data, callback) {
              if (data.from == data.to) {
                var r = confirm("Crear un bucle?");
                if (r != true) {
                  callback(null);
                  return;
                }
              }
              document.getElementById('edge-operation').innerHTML = "Añadir Arista";
              editEdgeWithoutDrag(data, callback);
            },
            editEdge: {
              editWithoutDrag: function (data, callback) {
                document.getElementById('edge-operation').innerHTML = "Editar Arista";
                editEdgeWithoutDrag(data, callback);
              }
            }
          }
        };
        // console.log(data);
        network = new vis.Network(container, data, options);

        const añadirNodo = (nodeData, callback) => {
    if (nodes.length === 0) {
        nodeIdCounter = 0;
    }
    var label = prompt("Nombre del nodo:");
    
    nodeData.id = nodeIdCounter++;
    nodeData.label = label;
    nodeData.title = "Nodo " + label;
    callback(nodeData);
}

      }

      function editNode(data, callback) {
        document.getElementById('node-label').value = data.label;
        document.getElementById('node-saveButton').onclick = saveNodeData.bind(this, data, callback);
        //console.log(callback);
        // document.getElementById('node-cancelButton').onclick = clearNodePopUp.bind();
        document.getElementById('node-popUp').style.display = 'block';
      }

      function clearNodePopUp() {
        document.getElementById('node-saveButton').onclick = null;
        // document.getElementById('node-cancelButton').onclick = null;
        document.getElementById('node-popUp').style.display = 'none';
      }

      function cancelNodeEdit(callback) {
        clearNodePopUp();
        callback(null);
      }

      function saveNodeData(data, callback) {
        data.label = document.getElementById('node-label').value;
        clearNodePopUp();
        callback(data);
      }

      function editEdgeWithoutDrag(data, callback) {
        // filling in the popup DOM elements
        document.getElementById('edge-label').value = data.label;
        document.getElementById('edge-saveButton').onclick = saveEdgeData.bind(this, data, callback);
        //document.getElementById('edge-cancelButton').onclick = cancelEdgeEdit.bind(this,callback);
        document.getElementById('edge-popUp').style.display = 'block';
      }

      function clearEdgePopUp() {
        document.getElementById('edge-saveButton').onclick = null;
        //document.getElementById('edge-cancelButton').onclick = null;
        document.getElementById('edge-popUp').style.display = 'none';
      }

      function cancelEdgeEdit(callback) {
        clearEdgePopUp();
        callback(null);
      }

      function saveEdgeData(data, callback) {
        if (typeof data.to === 'object')
          data.to = data.to.id
        if (typeof data.from === 'object')
          data.from = data.from.id
        data.label = document.getElementById('edge-label').value;
        clearEdgePopUp();
        callback(data);
      }
      function iden_grafo() {
        return document.getElementById('grafo').value;
      }
      function init() {
        setDefaultLocale();
        document.getElementById('locale').style.display = 'none';
        draw();
      }

  </script>
  <!-- Custom styles for this template -->
</head>

<body onload="init();" style="background-color: #ffffff ">
  <header id="titulo">
    <center>
      <h1>ANÁLISIS DE ALGORITMOS</h1>

      <h2>ALGORITMO DE JOHNSON</h2>
      <h2>SOARING PENGUINS</h2>
    </center>
    <aside id="columna2">
      <nav id="menu">
        <li><a href="inicio.html">GRAFOS</a></li><br><br>

        <li><a href="jhonson.html">JHONSON</a></li><br><br>
        <li><a href="asignacion.html">ASIGNACION</a></li><br><br>

      </nav>
    </aside>
    <aside id="columna">
      <nav id="menu">
        <li><button type="button" class="btn btn-primary" id="export_button" onclick="ver()">Resultado</button></li><br>
        <li><button type="button" class="btn btn-primary " id="export_button1" onclick="actualizar()">Nuevo</button>
        </li><br>
        <li><button type="button" class="btn btn-primary " id="export_button2"
            onclick="location.href='muJohnson.html'">Manual</button></li><br>

        <li> <button type="button" onclick="MostrarMatriz()" class="btn btn-success">Mostrar Matriz</button>
        </li>
      </nav>
    </aside>
  </header>
  <center>
    <div class="container">
      <h1 id="mostrarmat"></h1>
      <div class="row">
        <div class="col-lg-12 text-center">
          <p>
            <!--  <label for="locale">Select a locale:</label>-->
            <select id="locale" onchange="draw();">
              <option value="en">en</option>
              <option value="de">de</option>
              <option value="es">es</option>
              <option value="it">it</option>
              <option value="nl">nl</option>
              <option value="pt-br">pt</option>
              <option value="ru">ru</option>
            </select>
          </p>
          <div id="node-popUp">
            <span id="node-operation">NODO</span> <br>
            <table style="margin:auto;">
              <!-- <tr>
                      <td>id</td><td><input id="node-id" value="new value" /></td>
                    </tr>-->
              <tr>
                <td>VALOR</td>
                <td><input type="number" id="node-label" value=""></td>
              </tr>
            </table>
            <input type="button" value="GUARDAR" id="node-saveButton" />
            <!--<input type="button" value="cancel" id="node-cancelButton" />-->
          </div>

          <div id="edge-popUp">
            <span id="edge-operation">ARISTA</span> <br>
            <table style="margin:auto;">
              <tr>
                <td>VALOR</td>
                <td><input type="number" id="edge-label" value=""></td>
              </tr>
            </table>
            <input type="button" value="GUARDAR" id="edge-saveButton" />
            <!--<input type="button" value="cancel" id="edge-cancelButton" />-->
          </div>

        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <div id="mynetwork"></div>

        </div>

      </div>

    </div><br>


    <style type="text/css">
      .tg {
        border-collapse: collapse;
        border-spacing: 0;
      }

      .tg td {
        border-color: black;
        border-style: solid;
        border-width: 1px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        overflow: hidden;
        padding: 10px 5px;
        word-break: normal;
      }

      .tg th {
        border-color: black;
        border-style: solid;
        border-width: 1px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        font-weight: normal;
        overflow: hidden;
        padding: 10px 5px;
        word-break: normal;
      }

      .tg .tg-baqh {
        text-align: center;
        vertical-align: top
      }

      .tg .tg-lmf7 {
        background-color: #96fffb;
        color: #000000;
        font-family: "Lucida Console", Monaco, monospace !important;
        text-align: center;
        vertical-align: top
      }

      .tg .tg-6hok {
        background-color: #96fffb;
        font-weight: bold;
        text-align: center;
        vertical-align: top
      }
    </style>
    <table class="tg" style="undefined;table-layout: fixed; width: 515px">
      <colgroup>
        <col style="width: 239px">
        <col style="width: 276px">
      </colgroup>
      <thead>
        <tr>
          <th class="tg-lmf7"><span style="font-weight:bold">REFERENCIA</span></th>
          <th class="tg-6hok">IMAGEN</th>
        </tr>
      </thead>

        <tr>
          <td class="tg-baqh">Línea crítica</td>
          <td class="tg-baqh"><img
              src="https://w7.pngwing.com/pngs/667/465/png-transparent-red-line-arrow-arrow-gules-line.png" alt="Image"
              width="200" height="100"></td>
        </tr>
        <tr>
          <td class="tg-baqh">Nodos</td>
          <td class="tg-baqh">
            Nodo
            <h3 id="vernodos"></h3>


          </td>
        </tr>

    </table>

    <table id="matrizFinal" class="table table-striped">

    </table>


  </center>
  <center>
    <!--    <div class="d-grid gap-2" width=100px>-->
          <button type="button" onclick="descarga()" class="btn btn-success">Guardar</button>
    <!--       <button type="button" onclick="mostrarMatrizsol()" class="btn btn-success">Mostrar Matriz</button>-->
  
       <!-- </div>-->
       <div>
        <input class="form-control form-control-lg" id="import" type="file">
      </div>
      </center>
  <script type="text/javascript">


// Nodes and Edges counter.
var nodeIdCounter = 0;
var edgesIdCounter = 0;
// Create the network.
var container = document.getElementById("mynetwork");


      var nodos_dia;
      var id_dia;

      var nodos
        var aristas

        
      function ver() {
        //var ele=network.body.data.nodes._data;
        var mostrar = "\t\t\t";
        //onsole.log(network.body);
        nodos = network.body.data.nodes.length;
        aristas = network.body.data.edges.length;
        var id_nod = "";
        var temp_nodo = "";
        var id_arit = "";
        var temp_arit = "";
        console.log("Nodos abc: "+nodos+" Aristas abc: "+aristas);

        //
        //En esta parte obtengo los  los nodos
        //
        // mostrar+="Estos son los nodos\n";
        nodos_dia = [];
        id_dia = [];
        nodos_posix = [];
        nodos_posiy = [];
        for (var i = 0; i < nodos; i++) {
          id_nod = network.body.nodeIndices[i];//Obtencion del id
          temp_nodo = network.body.data.nodes._data[id_nod];
          //temp_nodo.label=i; //se captura el nodo como un objeto
          id_dia.push(temp_nodo.id);
          nodos_dia.push(temp_nodo.label);
          nodos_posix.push(temp_nodo.x);
          nodos_posiy.push(temp_nodo.y);
        }






        var aristas_a = [];
        var aristas_a2 = [];
        for (var i = 0; i < aristas; i++) {
          aristas_a[i] = [];
          id_arit = network.body.edgeIndices[i];
          temp_arit = network.body.data.edges._data[id_arit];
          aristas_a2.push(temp_arit.id);
          var origen = indexofarray_b(temp_arit.from, id_dia);//ubicar_nodo(temp_arit.from);
          aristas_a[i].push(origen);
          var destino = indexofarray_b(temp_arit.to, id_dia); //ubicar_nodo(temp_arit.to);
          aristas_a[i].push(destino);
          var valor = temp_arit.label;
          aristas_a[i].push(valor);
          // console.log(origen+" "+destino);

          //console.log(valor);
          //mostrar+="Arista DE: "+origen+" HACIA: "+destino+" VALOR: "+valor+"\n";
        }
        //console.log(aristas_a2.length);
        var nueva_matriz = new construir_matriz(nodos_dia, id_dia, aristas_a, aristas);
        var inicio = def_ini(nueva_matriz.mat2, nodos);
        var fin = def_fin(nueva_matriz.mat2, nodos);
        var parti = new array_inicio(nueva_matriz.mat1, nueva_matriz.mat2, inicio, fin, nodos);
        console.log('nueva matriz mat 1');
        console.log(nueva_matriz.mat1);
        console.log('nueva matriz mat 2');
        console.log(nueva_matriz.mat2);
        console.log('nodos posiy');
        console.log(nodos_posiy);
        console.log('nodos posix');
        console.log(nodos_posix);
        console.log('nodos_dia');
        console.log(nodos_dia);
        console.log('id dia');
        console.log(id_dia);
        console.log('Inicio');
        console.log(parti.i);
        console.log('Llegada');
        console.log(parti.l);
        console.log('Holguras');
        console.log(parti.h);
        recorrido(parti.h);
        //console.log(nueva_matriz);
        redibujar(id_dia, nodos_dia, nodos_posix, nodos_posiy, parti.i, parti.l, nueva_matriz.mat1, parti.h, nueva_matriz.mat2);
        //document.getElementById("resultado").innerHTML = mostrar;
        document.getElementById("vernodos").textContent = nodos_dia;
        console.log("aaaaaaaa");
      }
      function contarceros(matriz) {
        var n = 0;
        for (var i = 0; i < matriz.length; i++) {
          for (var j = 0; j < matriz.length; j++) {
            if (matriz[i][j] == 0)
              n++;
          }
        }
        return n;
      }
      function recorrido(matriz) {
        var dir = [];
        dir.push(1);
        var n = 0;
        var c = contarceros(matriz);
        for (var e = 0; e < c; e++) {
          for (var i = 0; i < matriz.length; i++) {
            if (matriz[n][i] == 0) {
              n = i;
              dir.push(i + 1);
              break;
            }
          }
        }
        console.log(dir);
      }

      const generarMatriz = () => {
        let matrix = Array(nodes.length).fill(0).map(() => Array(nodes.length).fill(0));

        edges.forEach((edge) => {
          matrix[parseInt(edge.from)][parseInt(edge.to)] = edge.label;
        });

        rowList = [];
        colList = [];

        for (let i = 0; i < matrix.length; i++) {
          sumRow = 0;
          sumCol = 0;
          for (let j = 0; j < matrix.length; j++) {
            sumRow += parseFloat(matrix[i][j]);
            sumCol += parseFloat(matrix[j][i]);
          }
          rowList.push(sumRow);
          colList.push(sumCol);
        }
        nombresNodos = [];

        let showMatrix = " ,";
        nodes.forEach((node) => {
          showMatrix += node.label + ",";
          nombresNodos.push(node.label);
        });

        showMatrix += "SUMA|";

        for (let i = 0; i < matrix.length; i++) {
          showMatrix += nombresNodos[i] + ",";
          for (let j = 0; j < matrix.length; j++) {
            showMatrix += matrix[i][j] + ",";
          }

          showMatrix += rowList[i] + "|";
        }

        showMatrix += "SUMA,";
        colList.forEach((col) => (showMatrix += col + ","));

        console.log("ShowMatrix ", showMatrix)
        //parseArray(showMatrix);
      };
      const crearTabla = (datos) => {
        document.getElementById("matrizFinal").innerHTML = "";
        var tabla = document.getElementById("matrizFinal");

        var cuerpo = createCustomElement("tbody");

        tabla.innerHTML = "";

        datos.forEach(function (datosFilas) {
          var fila = createCustomElement("tr");
          datosFilas.forEach(function (data) {
            var celda = createCustomElement("th");

            celda.appendChild(document.createTextNode(data));
            fila.appendChild(celda);
          });

          cuerpoTabla.appendChild(fila);
        });

        tabla.appendChild(cuerpo);
      };
      function MostrarMatriz() {
        var arrayNodos = [];
        var arrayEnlaces = [];
        let aux = 0;

        if (edges.length !== null) {
          while (aux < edges.length) {
            const nodes = edges.get(aux).from.toString() + "-" + edges.get(aux).to.toString(); //Obtiene el id del nodo origen y destino
            const values = edges.get(aux).label; //Obtiene el valor entre dos nodos
            console.log("Nodos");
            console.log(nodes);
            console.log("Valores");
            console.log(values);
            arrayNodos.push(nodes);
            arrayEnlaces.push(values);
            aux++;
          }

          aux = 0;
          var matrix = Array(nodes.length).fill(0).map(() => Array(nodes.length).fill(0)); //Construccion bruta de la matriz
          while (aux < arrayNodos.length) {
            var split = arrayNodos[aux].split("-");
            matrix[parseInt(split[1])][parseInt(split[0])] = arrayEnlaces[aux];
            aux++;
          }

          var Filas = [];
          var Columnas = [];
          // Suma de filas y columnas
          for (let i = 0; i < matrix.length; i++) {
            var sumaFilas = 0;
            var sumaColumnas = 0;
            for (let j = 0; j < matrix.length; j++) {
              sumaFilas += parseFloat(matrix[i][j]);
              sumaColumnas += parseFloat(matrix[j][i]);
            }
            Filas.push(sumaColumnas);
            Columnas.push(sumaFilas);
          }

          var matriz = ",";
          aux = 0;
          while (aux < nodes.length) {
            matriz += nodes.get(aux).label + ",";
            aux++;
          }
          matriz += "|";

          // Construir la matriz e insertar resultantes de la sumatoria

          for (let i = 0; i < matrix.length; i++) {
            matriz += nodes.get(i).label + ",";
            for (let j = 0; j < matrix.length; j++) {
              matriz += matrix[j][i] + ",";

            }
            matriz += Filas[i] + "|";
          }

          aux = 0;
          matriz += ",";
          while (aux < Columnas.length) {
            matriz += Columnas[aux] + ",";
            aux++;

          }
        }
        console.log(matriz);
        toMatrix(matriz);
      }
      function ubicar_nodo(id) {
        return network.body.data.nodes._data[id].label;
      }
      function indexofarray_b(val, arreglo) {
        // console.log("Tengo: "+arreglo.length);
        for (var i = 0; i < arreglo.length; i++) {
          var n = val.localeCompare(arreglo[i])
          if (n == 0) {
            return i;
          }
        }
      }
      function actualizar() {
        location.reload();
      }
      function construir_matriz(nodos_dia, id_dia, aristas_a, aristas_a2) {

        //var tipo_g=document.getElementById('grafo').value;
        var matriz1 = [];
        var matriz_pos = [];
        //console.log(nodos_dia.length);
        for (var i = 0; i < nodos_dia.length; i++) {
          matriz1[i] = [];
          for (var j = 0; j < nodos_dia.length; j++) {
            matriz1[i][j] = 0;
          }
        }
        for (var i = 0; i < nodos_dia.length; i++) {
          matriz_pos[i] = [];
          for (var j = 0; j < nodos_dia.length; j++) {
            matriz_pos[i][j] = 0;
          }
        }

        for (var i = 0; i < aristas_a2; i++) {
          matriz1[aristas_a[i][0]][aristas_a[i][1]] = parseInt(aristas_a[i][2]);
          matriz_pos[aristas_a[i][0]][aristas_a[i][1]] = 1;
        }
        mostrarMatrizsol(matriz1);
        console.log("matriz z")
        console.log(matriz1);
        return {

          mat1: matriz1,
          mat2: matriz_pos

        };



      }
      function mostrarMatrizsol(matrizsol) {
        let mosmatriz = "Matriz Solucion: <br>";
        console.log("bbbbbbbbbbb")
        console.log(matrizsol)
        let la = matrizsol.length;
        for (var i = 0; i < la; i++) {
          let las = matrizsol[i].length;
          for (var j = 0; j < las; j++) {
            mosmatriz = mosmatriz + matrizsol[i][j] + " | ";
          }
          mosmatriz = mosmatriz + "<br>";
        }
        console.log(mosmatriz)
        document.getElementById("mostrarmat").innerHTML = mosmatriz;
      }

      function def_ini(matriz, len) {
        var s;
        var inicios = new Array();
        for (var i = 0; i < len; i++) {
          s = 0;
          for (var j = 0; j < len; j++) {
            s += parseInt(matriz[j][i]);
          }
          if (s == 0) {
            inicios.push(i);
          }
        }
        return inicios;
      }
      function def_fin(matriz, len) {
        var s;
        var fin = new Array();
        for (var i = 0; i < len; i++) {
          s = 0;
          for (var j = 0; j < len; j++) {
            s += parseInt(matriz[i][j]);
          }
          if (s == 0) {
            fin.push(i);
          }
        }
        return fin;
      }
      
      function array_inicio(matriz, matriz_pos, inicio, fin, len) {
        //llena la cola
        var cola = [];
        //iniciar el vector de llegada
        var partida = new Array();
        for (var i = 0; i < len; i++) {
          partida[i] = -1;
        }
        var llega = new Array();
        for (var i = 0; i < len; i++) {
          llega[i] = Number.MAX_VALUE;
        }
        for (i = 0; i < inicio.length; i++) {
          partida[inicio[i]] = 0;
        }
        console.log(partida);
        //recorrido del inicio para adelante
        for (var i = 0; i < inicio.length; i++) {
          for (var j = 0; j < len; j++) {
            if (matriz_pos[inicio[i]][j] == 1) {
              cola.push(inicio[i]);
              cola.push(j);
            }
          }
        }
        //console.log('Cola dinamica');
        while (cola.length > 0) {

          var suma_temp = partida[cola[0]] + matriz[cola[0]][cola[1]];
          if (suma_temp > partida[cola[1]]) {
            partida[cola[1]] = suma_temp;
          }
          console.log(partida);
          for (var i = 0; i < len; i++) {
            if (matriz_pos[cola[1]][i] != 0) {
              cola.push(cola[1]); cola.push(i);//almacenamos posiciones
              console.log(cola);
            }
          }

          cola.shift(); cola.shift();
        }
        llega[fin[0]] = partida[fin[0]];
        //console.log(llega);
        //console.log(partida);
        //recorrido de fin hacia atras
        for (var i = 0; i < fin.length; i++) {
          for (var j = 0; j < len; j++) {
            if (matriz_pos[j][fin[i]] == 1) {
              cola.push(j);
              cola.push(fin[i]);
            }
          }
        }
        while (cola.length > 0) {

          var resta_temp = llega[cola[1]] - matriz[cola[0]][cola[1]];
          if (resta_temp < llega[cola[0]]) {
            llega[cola[0]] = resta_temp;
          }
          console.log(llega);
          for (var i = 0; i < len; i++) {
            if (matriz_pos[i][cola[0]] != 0) {
              cola.push(i); cola.push(cola[0]);//almacenamos posiciones
              console.log(cola);
            }
          }

          cola.shift(); cola.shift();
        }
        //matriz de holguras
        var mat_h = [];
        for (var i = 0; i < len; i++) {
          mat_h[i] = [];
          for (var j = 0; j < len; j++) {
            mat_h[i][j] = -1;
          }
        }
        for (var i = 0; i < len; i++) {
          for (var j = 0; j < len; j++) {
            if (matriz_pos[i][j] == 1) {
              mat_h[i][j] = llega[j] - partida[i] - matriz[i][j];
            }
          }
        }
        return { i: partida, l: llega, h: mat_h };
      }

      function redibujar(id_dia, nodos_dia, nodos_posix, nodos_posiy, partida, llega, matriz, matriz_h, matriz_p) {
        destroy();
        var len = id_dia.length;
        var array_nodos = [];
        for (var i = 0; i < len; i++) {
          array_nodos.push({ id: i, label: nodos_dia[i] + "\n" + partida[i] + "|" + llega[i], shape: 'box', color: '#97C2FC', x: nodos_posix[i], y: nodos_posiy[i] });
        }
        var nodes = new vis.DataSet(array_nodos);
        var array_aristas = [];
        for (var i = 0; i < len; i++) {
          for (var j = 0; j < len; j++) {
            if (matriz_p[i][j] == 1) {
              if (matriz_h[i][j] == 0) {
                array_aristas.push({ from: i, to: j, label: "A=" + matriz[i][j] + "\nH=" + matriz_h[i][j], font: { align: 'top' }, color: { color: 'red' }, arrows: 'to' });
              } else {
                array_aristas.push({ from: i, to: j, label: "A=" + matriz[i][j] + "\nH=" + matriz_h[i][j], font: { align: 'top' }, color: { color: 'black' }, arrows: 'to' });
              }
            }
          }
        }
        // create an array with edges
        var edges = new vis.DataSet(array_aristas);
        /* {from: 1, to: 8, color:{color:'red'},arrows:'to'},
         {from: 1, to: 3, color:'rgb(20,24,200)'},
         {from: 1, to: 2, color:{color:'rgba(30,30,30,0.2)', highlight:'blue'}},
         {from: 2, to: 4, color:{inherit:'to'}},
         {from: 2, to: 5, color:{inherit:'from'}},
         {from: 5, to: 6, color:{inherit:'both'}},
         {from: 6, to: 7, color:{color:'#ff0000', opacity:0.3}},
         {from: 6, to: 8, color:{opacity:0.3}},
       ]);*/

        // create a network
        var container = document.getElementById('mynetwork');
        var data = {
          nodes: nodes,
          edges: edges
        };
        var options = {
          nodes: {
            shape: 'circle'
          },
          physics: false
        };
        var network = new vis.Network(container, data, options);
      }

      function abrir() {
        var popup = document.getElementById("myPopup");
        popup.classList.toggle("show");
      }

function descarga() {
  console.log("inicio mierda")      
  console.log(nodos)
console.log(aristas)
console.log("fin mierda")
  filename = prompt("Ingrese el nombre del archivo: ");

  let file = new Blob([JSON.stringify(Arraydenodos())], { type: "aplication/.json" });
  let a = document.createElement("a");
  a.href = URL.createObjectURL(file);
  a.download = filename + '.json';
  a.click();
  
}
//Guardar archivo
function Arraydenodos() {
  var array1 = [];
  var array2 = [];
  array1 = nodos_dia;
  array2 = aristas;
  const s = nodes.forEach((nodos) => {
    console.log(nodos)
    array1.push({ id: nodo.id, label: nodo.label });
  });
  const n = edges.forEach((aristas) => {
    array2.push({ from: linea.from, to: linea.to, id: linea.id, label: linea.label });
  });
  var data1 = {
    node: array1,
    edge: array2,

  };
  console.log(data1);
  return (data1);
}

document.getElementById('import').addEventListener('change', leerArchivo, false);


function leerArchivo(e) {
  var archivo = e.target.files[0];
  if (!archivo) {
    return;
  }
  var lector = new FileReader();
  lector.onload = function (e) {
    var contenido = e.target.result;
    gf = JSON.parse(contenido);
    cargar(gf["node"], gf["edge"]);
  }
  lector.readAsText(archivo);
}


function cargar(dn, de) {

  nodeIdCounter == dn[dn.length - 1]["id"];
  nodeIdCounter++;
  nodes = new vis.DataSet(dn);
  edges = new vis.DataSet(de);
  edgesIdCounter = de[de.length - 1]["id"];
  edgesIdCounter++;
  data = {
    nodes: nodes,
    edges: edges,
  };
  network2 = new vis.Network(container, data, options);
}

  </script>
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/popper/popper.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

</body>

</html>